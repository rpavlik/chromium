<!-- Copyright (c) 2001, Stanford University
     All rights reserved.

	 See the file LICENSE.txt for information on redistributing this software.  -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>New Page 1</title>
<base target="new_window">
<link rel="stylesheet" type="text/css" href="chromium.css">
</head>

<body bgcolor="#FFFFFF">

<h1 class="PageHeading">Chromium Graphical Configuration Tool</h1>
<p>The Chromium graphical configuration tool (hereafter called the config
tool) allows one to build a Chromium configuration with a GUI-based
interface, instead of writing Python configuration files.</p>

<p>Here's a screenshot showing a simple tile-sort configuration:</p>

<p align="center"><img border="0" src="configtool.gif"></p>


<h2 class="PageSubHeading">Setup</h2>

<p>The config tool is written in Python and uses the wxWindows GUI
toolkit.</p>

<p>
On a Linux system, you'll need the wxGTK and wxPython libraries.
If you're using Red Hat Linux the <code>wxGTK-2.3.2-1</code> and
<code>wxPython-2.3.2.1-1</code> RPMs are known to work.
</p>

<p>
On a Windows system, (finish this).
</p>


<h2 class="PageSubHeading">Running the Config Tool</h2>

<p>The config tool is in the <code>cr/mothership/tools/</code> directory.
Run it by typing <code>python configtool.py</code>
</p>

<p>You may optionally specify a Chromium configuration file to read
immediately.<br>
For example: <code>python configtool.py ../configs/crdemo.conf</code></p>

<p>Note to Unix users:  If you set the executable flag on
configtool.py with <code>chmod a+x configtool.py</code> you'll be able
to run the program directly, without invoking python directly.
</p>



<h2 class="PageSubHeading">Overview</h2>

<p>
A Chromium configuration is usually a directed acyclic graph (DAG).
The graph's nodes are displayed as boxes and the edges are drawn as lines.
With the graphical configuration tool you can add, remove and edit nodes
and edges with a graphical interface, instead of editing the text-based
Python configuration file.
</p>
<p>Typically, a new configuration will be created with a
<a href="#templates" target="_self">template</a>.
Alternately, a configuration can be built from scratch by creating
nodes, adding SPUs to the nodes, connecting the nodes and setting
various configuration options.
</p>



<h2 class="PageSubHeading">Nodes</h2>

<p>Application nodes are represented by green boxes and network/server
nodes are represented by red boxes.
Each node icon may contain an SPU chain, shown as a sequence of gray boxes.
Nodes and SPUs are labeled accordingly.
</p>

<p>Application and network/server nodes may be created with the
<b>New App Node(s)</b> and <b>New Server Node(s)</b> buttons.
You can create 1, 2, 3, 4 or N instances of either type of node.
</p>

<p>Nodes may be selected and moved using the mouse.
Selected nodes have a thick black outline.
You may extend the selection by <em>shift-clicking</em>.
You can toggle the selection status of a node by <em>control-clicking</em>.
</p>

<p>The <b>Node</b> menu has commands that apply to the currently
selected nodes.
Most are self-explanatory, some are described in more detail below.
</p>

<p><em>Compound nodes</em> are a compact way to represent a set of many
similar nodes.
For example, if your configuration has 8 rendering nodes, you may represent
them using a single compound node, rather than 8 individual nodes.
A compound node looks like this:
</p>
<p align="center"><img border="0" src="compoundnode.gif"></p>

<p>The compound node displays a count which indicates how may nodes are
represented by the icon.
You can change the count with the <b>Node / Node Count</b> menu item.
Compount nodes may be split into a set of individual, non-compound
nodes with the <b>Node / Split</b> menu item.
A set of similar, individual nodes may be combined into a compound node
with the <b>Node / Merge</b> menu item.
</p>

<p>Nodes have hostnames to indicate the computer on which they run.
The hostname can be set for the selected nodes with the
<b>Node / Host Name</b> menu item.  The following dialog will appear:</p>

<p align="center"><img border="0" src="hostname_dialog.gif"></p>

<p>There are two sections to the dialog:</p>
<ol>
<li><em>Generate Host Names</em> - this section lets you easily generate
    a sequence of numbered hostnames.
    If the pattern string contains a # symbol, the # will be replaced by
    an index.
    The first index and number of names to generate are set wit the
    <em>First Index</em> and <em>Count</em> controls.
    Click on <em>Generate</em> to generate the hostnames.</p>
<li><em>Edit Host Names</em> - in this section you can select a host name,
    move it up or down in the list, delete it or rename it using the
    buttons in the upper-right corner of the list.
</ol>

<p>When finished, choose <b>OK</b> or <b>Cancel</b>.

<p>The <b>Edit</b> menu has <b>Cut</b>, <b>Copy</b>, and
<b>Paste</b> commands.  These are useful for moving parts of
configuration graphs between two projects.</p>



<h2 class="PageSubHeading">SPUs</h2>

<p>Nodes contain SPU chains.  SPU chains are seen as one or more gray,
labeled boxes inside node icons.
</p>

<p>To add a new SPU to a node, first select the node, then choose the
SPU type from the <b>New SPU</b> button.
If no SPUs are currently selected in the node, the new SPU will be added
to the end of the SPU chain.
If one or more SPUs are currently selected in the node, the new SPU will
be added in front of the selected SPU.
</p>

<p>As with nodes, SPUs may be selected and deselected by clicking on them
with the mouse.  The <em>shift</em> and <em>control</em> keys may be used
while clicking to extend and toggle selection status, respectively.</p>

<p>The <b>SPU</b> menu has commands that apply to the currently selected SPUs.
</p>

<p>The <b>SPU / Options</b> menu item will open a dialog which allows you to
configure the selected SPUs.
If more than one SPU is selected, all selected SPUs must be of the same type.
The new SPU settings will be applied to all selected SPUs.
</p>

<p>Here are the options for the render SPU:</p>

<p align="center"><img border="0" src="renderspu_options.gif"></p>

<p>The <em>Restore Defaults</em> button will reset all options to their
default values</p>

<p>Documentation for SPU options can be found in the section
<a href="configoptions.html" target="_self">Configuration Options for provided SPUs</a>.
</p>



<h2 class="PageSubHeading">Client / Server Connections</h2>

<p>Some SPUs (such as pack and tilesort) have a packer which allows them
to be connected to downstream servers.
Such SPUs have a black, rectangular <em>socket</em> on their right edge.
Similarly, servers have a black, rectangular <em>socket</em> on their
left edge.
Connections between packing SPUs and servers are drawn as blue lines.</p>

<p>To connect nodes (i.e. connect a packing SPU to a server node) use the
<b>Node / Connect</b> menu item.
You must have at least two nodes selected, one must be a server and
the other must have an SPU chain that ends with a packing SPU.</p>

<p>If more than two SPUs are selected, the configuration tool will do
its best to determine the desired connection topology, but it may make
mistakes.</p>

<p>Nodes may be disconnected by selecting the nodes and choosing
the <b>Node / Disconnect</b> menu item.<p>



<h2 class="PageSubHeading">Application Node Options</h2>

<p>Application nodes can be configured by selecting them and then choosing
<b>App Node Options</b> from the <b>Node</b> menu.
When you chose it, the following dialog appears:</p>

<p align="center"><img border="0" src="appoptions_dialog.gif"></p>

<p>
The three fields labeled <b>Command</b>, <b>Zeroth arg</b>, and
<b>Start Directory</b> control execution of the application program.
</p>

<p>
<b>Command</b> specifies the the default program and command line
arguments to run with this configuration.
There are three special substitutions that may be made:
<ul>
<li>%N will be replaced by the number of application nodes.
<li>%I will be replaced by the index of the application node, starting
    with zero.
<li>%0 will be replaced by a the <b>Zeroth arg</b>, if specified.
</ul>
<p>
These substitutions are useful for multi-client configurations.
Suppose, for example, that you're using a sort-last configuration
with 4 application/rendering nodes and want to run the psubmit demo
program.</p>

<p>The command would be "<code>psubmit -size %N -rank %I -clear %0</code>"
and the zeroth argument would be "<code>-swap</code>".</p>

<p>As a result, the four instances of the application nodes would be
run with the following command lines:<p>
<ul>
<li>App node 0:  <code>psubmit -size 4 -rank 0 -clear -swap</code>
<li>App node 1:  <code>psubmit -size 4 -rank 1 -clear</code>
<li>App node 2:  <code>psubmit -size 4 -rank 2 -clear</code>
<li>App node 3:  <code>psubmit -size 4 -rank 3 -clear</code>
</ul>

<p>
The <b>Start Directory</b> parameter specifies the directory in which the
crappfaker should be started.  This will be the application's current
working directory.
</p>

<p>
The <b>Client DLL</b> parameter specifies the directory to search to
find the <em>faker</em> library.
</p>

<p>
The <b>SPU Directory</b> parameter specifies the directory to search
when loading SPUs.
</p>

<p>
The <b>Minimum Chromium App Window Size</b> and
<b>Match App Window Title</b> controls are useful for multi-context/window
applications.
They're described in the <a href="configapp.html" target="_self">
application node configuration</a> section.
<p
</p>

<p>
When the <b>Track App Window Size Changes</b> control is checked,
Chromium will monitor the size of the original application window and
tell down stream Chromium SPUs to adjust their window sizes whenever
the application window is resized.
</p>

<p>
When the <b>Show Virtual Cursor</b> control is checked, Chromium will
monitor the current mouse pointer position in the application window
and draw a virtual cursor in the Chromium render SPU windows.
This is useful for interactive application that have direct manipulation.
</p>


<h2 class="PageSubHeading">Server Node Options</h2>


<p>Server nodes can be configured by selecting them and then choosing
<b>Server Node Options</b> from the <b>Node</b> menu.
When you chose it, the following dialog appears:</p>

<p align="center"><img border="0" src="serveroptions_dialog.gif"></p>

<p>
The <b>Optimized Extent Bucketing</b> control is used when there are
two or more images tiles present in the server node's rendering window.
A special hash-based algorithm will be used to determine which tiles
a primitive intersects.
If option offers improved server performance, but all tiles must be
the same size.
</b>

<p>
The <b>Generate Lightning-2 Strip Headers</b> option is for use with
the Lightning-2 hardware image compositor.
It controls whether special compositing codes are embedded in 2-pixel
wide columns between tiles.
(currently not implemented in the server)
</p>

<p>
The <b>Only swap once for N clients</b> option is useful for sort-last
rendering, or when a server has several clients.
When enabled, OpenGL SwapBuffer commands will only be executed for
one of the N client nodes.
If all clients were to do a SwapBuffers, the image would flicker.
</p>

<p>
The <b>SPU Directory</b> parameter specifies the directory to search
when loading SPUs.
</p>



<h2 class="PageSubHeading">Mothership Options</h2>

<p>
Choosing <b>Options</b> from the <b>Mothership</b> menu opens the
mothership options dialog.
There are only two controls.
</p>

<p>
The <b>Max Transmission Unit</b> controls the maximum buffer sized
used for inter-node communication, in bytes.
The default is 1MB.
</p>

<p>
The <b>Automatically Start Servers</b> option, when enabled, will
cause the mothership to automatically spawn crserver and crappfaker
processes for each node (currently limited to sh and rsh on Unix).
This means you don't have to manually start these processes.
</p>


<h2 class="PageSubHeading">Mothership Run / Stop</h2>

<p>The <b>Mothership</b> menu has <b>Run</b> and <b>Stop</b> items.
The <b>Run</b> item will spawn the Chromium mothership as a new
process.
The <b>Stop</b> item will kill the spawned mothership.
</p>
<p>
If the mothership option to automatically start crservers and crappfakers
is enabled, your Chromium configuration and application should run
automatically.
Otherwise, you'll have to start the crserver and crappfaker processes
yourself, as this option <em>only</em> directly spawns the mothership.
</p>


<a name="templates">
<h2 class="PageSubHeading">Templates</h2>
</a>

<p>Templates allow one to quickly create common Chromium configurations
without having to create individual nodes, SPUs and connections.
To instantiate a template, choose the desired template from the
<b>New Template</b> button.</p>

<p>When you instantiate a template you'll often be prompted for a few
parameters such as number of application nodes, mural rows and columns, etc.
The configuration will be generated when you click on the <b>OK</b> button.
</p>

<p>Templates may be edited with special, easy-to-use dialogs.
Click on the <b>Edit Template</b> button to open the editor, if supported.
</p>

<p>Currently, there are three templates:
</p>
<ul>

<li><a href="tilesort_template.html" target="_self">tile-sort</a>
- sort-first tiled rendering typically used to drive large mural displays.
<li><a href="sortlast_template.html" target="_self">sort-last</a>
- parallel rendering with per-pixel image compositing.
<li><a href="reassembly_template.html" target="_self">image reassembly</a>
- sort-first tiled rendering with image reassembly.
</ul>

<p>The Chromium configuration tool may be extended with new types of
templates (it's a modular interface).
A template for binary-swap image composition is likely.
</p>



<h2 class="PageSubHeading">Hardware Description File</h2>

<p>The config tool looks for a special hardware description file when
a template is created.
This file contains cluster host names, the mural size, screen sizes, etc.
If you set up this file, it'll save you some time when designing a new
Chromium configuration.
</p>
<p>
Here's a sample of the file:
</p>
<pre>
{
    "mural_size" : (2, 2),          # (cols, rows)
    "screen_size" : (1280, 1024),   # in pixels
    "tile_size" : (256, 256),       # for lightning-2 (in pixels)
    "frontend_hosts" : ["localhost"],
    "cluster_hosts" : ["cr1", "cr2", "cr3", "cr4"],
    "cluster_pattern" : ("cr#", 1)
}
</pre>

<p>
The file format can be directly parsed by Python (it's a dictionary
which maps configuration option names to values.)
</p>

<p>
In this case, we set the following parameters:
</p>

<ul>
<li><code>mural_size</code> - this defines the size of your mural display
in terms of columns and rows of screens.  In this case, there are two
rows of two screens.
<li><code>screen_size</code> - this indicates that each screen of each
rendering host is 1280 x 1024 pixels in size.
<li><code>tile_size</code> - for a tile-reassembly configuration (such
as used with Lightning-2) this indicates the default tile size in pixels.
<li><code>frontend_hosts</code> - this list contains the host names of the
client workstations.  Usually, there's only one name in this list.
In a typical tile-sort configuration, this will be the application host.
In a sort-last configuration, this would be the host that displays the
composited image.
<li><code>cluster_hosts</code> - this list contains the names of the systems
in the rendering cluster.  In this example there are four hosts, which
corresponds to the 2 by 2 mural size.
<li><code>cluster_pattern</code> - this tuple describes the naming
convention for the cluster.  In this example, the hostnames start with
the prefix "cr" and end with a number.  The first host is number 1.
Some sites may number their hosts starting at zero.
The <code>cluster_hosts</code> parameter has priority over the
<code>cluster_pattern</code> parameter if both are set.
</ul>

<p>
All the parameters are optional.  The config tool will use built-in
defaults if any of these fields aren't set.
</p>

<p>
Currently, this file is named <code>chromium.crsite</code> and should
be in the directory which the config tool is started.
The name and location of this file may change in the future.
</p>



</body>

</html>
